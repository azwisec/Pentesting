Account TakeOver Vulnerabilities.

1)Old Session Does Not expire
Steps:
-Create your account(1 a/c)
-Open 2 browser chrome and firefox
-Login in 2 browser 
-Reset the Password in one browser
-Reload the other browser.

Reports:
https://hackerone.com/reports/357625
https://hackerone.com/reports/1069392
https://hackerone.com/reports/514577

2)Session Hijacking (Intended Behaviour)
Steps:
-Create Your a/c and login.
-Use Cookie editor extention in browser.
-Copy all the target cookies.
-Logout your a/c
-Paste that cookies in cookie editor extention
-Refresh the page that you pasted the cookie.
Note-If you are logged in then we can do session hijacking.

Reports:
https://hackerone.com/reports/167460
https://hackerone.com/reports/137480
https://hackerone.com/reports/263873

3)Password Reset Link Token does not expire
-Create an a/c
-Request for forgot password link.
-Dont use that link that we have received in our email or phone number.
-Instead of logout we have to change our email address.
-Then after we have to use that link that we received in old email or phone number.
Note: Check if you are able to change your password.
If so it is a bug.

Reports: 
https://hackerone.com/reports/685007
https://hackerone.com/reports/170161
https://hackerone.com/reports/411337


4)Server Security misconfiguration  --> Lack of security headers or cache control for a security page.
-Login
-Navigate arount the pages.
-Logout
-Press (Alt+Left-arrow) or the backward button on browser.
-If you are stilll logged in and can view pages it is a BUG.

5)Chaining Session Hijacking with xss
-If you got a session hijacking in a brocken authentication and session management.
-If you find that on a target.
-Try any way to steal cookies on that targget.
-Look for xss.

https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-stealing-cookies
https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-capturing-passwords

6)No rate Limit on login with weak password policy.
-If we find a target that have a weak password policy.
-Try to no rate limit attack by createing very weak passwod of your account.

https://hackerone.com/reports/280389 no rate limit.


7)Password Reset Poisoning lead to token theft.
or 
Password Reset link hijacking via Host Header Poisoning
-After we login, we have to go to the password reset function.
-Enter email and intercept the request.
-Change host header to some other host
ie; 
Host: victim.com
	to
Host: attacker.com
-Forward this if you found that next request attacker.com and it means - you got succesfully theft the token.

Report:
https://hackerone.com/reports/167631
https://vbharad.medium.com/account-takeover-through-password-reset-poisoning-72989a8bb8ea

8)Cross Site Request Forgery for a/c tko
-Change password function 
-Email Change function 
-Changing security questioning.

9)Using Sensitive Data exposure.
This is depends on your luck.
Sometimes using fit reocon and google recon you may found files that cntains critical information like user tokens, usernames, and their passwords.
-Token are leaked publicaly.
-check for sensitive data in cookie fields.
-passwords disclosed in js files.
-Access to sensitive API calls without proper authorization.
-PII and Health records publicaly available.
-Password databases uses unsalted hashes.
-Check for the pages that contains Sensitive infromation  being cached.
-Unencryped communication on login pages. (securityheader.com)

10)Token Leaks in Response.
-There are different ways for do this but all are same.
-We have to find some EndPoints.( Register, Forgot Passsword)
-We have to do is, Register.
Steps:
-While registering and senting request intercept the signup request that contains data yout have entered.
-Click on action -> do -> Intercept response to this request.
-Then we have to click Forward, until we got a response.
-Check response  it that contains any link, any token or otp.

While on Password Reset.
Steps:
-Intercept the forgot password request after entering the credentials.
-Click on action -> do -> intercept response to this request.
-Click forward.
-Check response it that contains any link, any token or otp.

Note: Token or any link are may be exposed in request (refferer) header also.


11)OTP Bypass Response (register or Login or Password Reset)
Steps:
-Register 2 accounts with 2 mobile number(check the functionality and response of that requset)
-Intercept the request.
-Click on action --> Do intercept  --> Intecept response to this request.
-Check the message will displahy like status:1 or success:true etc..
-Follow same procedure wiht other account but we want to type wrong otp.
-Intercept the response to request
-See the message like you get status:0
-Change status:1 (to 1) and forward this request if you are logged in.
 
Note: If you are able to create an account after this we have done otp authentication bypass.


12)OTP Bypass on Register a/c via Response manipulation.
Steps:
-Register with mobile or email and request for otp
-Enter incorrect otp and capture the request in burp
-Do intecept response to this request and forwrd the request.
-Check the response same as given on 11.

