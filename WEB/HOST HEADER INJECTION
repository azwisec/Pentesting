What is an HTTP Header?
HTTP headers let the client and the server pass additional information with an HTTP request or response. 
An HTTP header consists of its case-insensitive name followed by a colon (:), then by its value.

What is a HOST Header?
The Host request header is the mandatory header (as per HTTP/1.1)that specifies the host and port number of the 
server to which the request is being sent.
If no port is included, the default port for the service requested is implied, 443 for an HTTPS URL, and 80 for an HTTP URL.
Example: Host: mysite.net

What is a FORWARDED Header?
The Forwardedheader contains information from the reverse proxy servers that is altered or lost when a proxy is 
involved in the path of the request.
The alternative and de-facto standard versions of this header are the X-Forwarded-For, X-Forwarded-Host and X-Forwarded-Proto headers.
This header is used for debugging, statistics, and generating location-dependent content and by design, it exposes privacy 
sensitive information, such as the IP address of the client.
Example: X-Forwarded-For: yoursafesite.net

What is the HOST header attack?
HTTP Host header attacks exploit vulnerable websites that handle the value of the Host header in an unsafe way. 
If the server implicitly trusts the Host header and fails to validate or escape it properly, an attacker may be able to use this input to inject harmful payloads that manipulate server-side behaviour.

What exactly could be the flaw, where it could go wrong?
Earlier each IP address would only host content for a single domain. But today, it is common for multiple websites and applications to be accessible under the same IP address. As multiple applications are accessible via the same IP address as regards to â€” Virtual hosting or Routing traffic via a proxy. It is easy to get lost searching for the origin. Therefore the application relies on the Host header to specify the intended recipient.

Im many cases, developers are trusting the HTTP Host Header value and using it to generate links, import scrpts and even generate password resets links with its value.
This is a very bad idea, because the HTTP Host Header can be controlled by an attacker. This can be exploited using web-cache poisoning and by abusing alternative channels like password reset emails.

Host:victim.com to Host:attacker.com

Hunting:
-Find a URL Having Status code 2xx and 3xx
-You have to try once on each 2xx

status code 200,201,202,203,204
status code 300,301,302,303,304

attacker.com

First Method:-
Change the host to bing.com

Secong Method:-
Change host from realweb.com to bing.com 
Set X-Forwarded-Host to realweb.com

Third Method:-
Set X-Forwarded-Host to bing.com
and Host to realweb.com


Resourses:
https://infosecwriteups.com/identifying-escalating-http-host-header-injection-attacks-7586d0ff2c67
https://medium.com/@5hank4r/bpasss-host-header-attacker-account-takeover-subdomain-takeover-d98fe0dc0cd0
https://pallabjyoti218.medium.com/how-how-i-am-able-to-steal-email-verification-token-by-host-header-poisoning-875bec0d477d
https://sushant-kamble.medium.com/account-takeover-chained-to-host-header-injection-7fef5a0c310a
https://geekboyranjeet.medium.com/host-header-injection-to-account-takeover-how-i-have-found-and-earned-with-poc-image-53c29b33e4d2
https://gupta-bless.medium.com/exploiting-host-header-injection-5554fef7e25
https://medium.com/@briskinfosec/host-header-attack-bc9e1e0ee297
https://sites.google.com/site/testsitehacking/10k-host-header
https://medium.com/infosec/how-i-was-able-to-take-over-any-users-account-with-host-header-injection-546fff6d0f2
https://blog.usejournal.com/bugbounty-database-hacked-of-indias-popular-sports-company-bypassing-host-header-to-sql-7b9af997c610
